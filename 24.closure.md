-   클로저는 함수와 그 함수가 선언된 렉시컬 환경과의 조합이다

# 렉시컬 스코프

-   자바스크립트 엔진은 함수를 어디에 정의했는지에 따라 상위스코프 결정
    -   이를 렉시컬 스코프(정적 스코프)라 함

# 함수 객체의 내부 슬롯 [[Environment]]

-   함수는 자신의 내부 슬롯 [[Environment]]에 자신이 정의된 환경, 상위 스코프의 참조를 저장
    -   해당 값이 외부 렉시컬 환경 참조에 저장될 참조값
    -   코드가 평가되는 시점에 `실행 중인 실행 컨텍스트의 렉시컬 환경`을 참조로 저장

# 클로저와 렉시컬 환경

```
const x = 1;

function outer() {
    const x = 10;
    const inner = function () { console.log(x); }
    return inner;
}

const innerFunc = outer();
innerFunc(); // 10
```

-   outer 함수는 inner 함수를 반환하고 생명주기 마감
-   하지만 x값이 유지됨

-   외부 함수보다 중첩 함수가 더 오래 유지되는 경우 중첩 함수는 이미 생명 주기가 종료한 외부 함수의 변수를 참조할 수 있음

    -   이러한 중첩 함수를 클로저라고 부름

-   이론적으로 모든 함수는 클로저 이나 그렇게 부르지 않음

    -   상위 스코프를 기억해서 값을 참조할 때
        -   상위 스코프의 어떤 식별자도 참조하지 않는 경우 대부분 브라우저는 최적화를 통해 상위스코프를 기억하지 않기 때문
            -   불필요한 메모리 낭비가 없어짐

-   클로저 : 중첩 함수가 상위 스코프의 식별자를 참조, 중첩 함수가 외부 함수보다 더 오래 유지되는 경우로 한정

# 클로저의 활용

-   상태를 안전하게 변경하고 유지하기 위해 사용
    -   상태를 안전하게 은닉
    -   특정 함수에게만 상태 변경 허용

```
const increase = (function () {
    let num = 0;

    return function () {
        return ++num;
    }
}());
```
